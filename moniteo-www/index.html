<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Hello Bulma!</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
  </head>
  <body>
  <section class="section">
    <div class="container">
      <h1 class="title">
        CLassement
      </h1>
      <p class="subtitle">
        Course <strong>2</strong>!
      </p>


      <table class="table" style="overflow-x: auto;">
        <thead>
          <tr>
            <th><abbr title="Position">Pos</abbr></th>
            <th>Dossard</th>
            <th>Nom</th>
            <th>Temps</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <th><abbr title="Position">Pos</abbr></th>
            <th>Dossard</th>
            <th>Nom</th>
            <th>Temps</th>
          </tr>
        </tfoot>
        <tbody id="table-body">
          <!--
          <tr>
            <th>1</th>
            <td><a href="https://en.wikipedia.org/wiki/Leicester_City_F.C." title="Leicester City F.C.">Leicester City</a> <strong>(C)</strong>
            </td>
            <td>38</td>
            <td>23</td>
            <td>12</td>
            <td>3</td>
            <td>68</td>
            <td>36</td>
            <td>+32</td>
            <td>81</td>
            <td>Qualification for the <a href="https://en.wikipedia.org/wiki/2016%E2%80%9317_UEFA_Champions_League#Group_stage" title="2016â€“17 UEFA Champions League">Champions League group stage</a></td>
          </tr>
          -->
        </tbody>
      </table>
    </div>
  </section>
  </body>

  <script src="//cdn.jsdelivr.net/npm/pouchdb@8.0.1/dist/pouchdb.min.js"></script>
  <script src="//unpkg.com/alpinejs" defer></script>

  <script>

    function updateTable(doc) {
      const tableBody = document.getElementById("table-body");
      tableBody.innerHTML = ""; // Efface le contenu actuel du tableau
      
      let i = 1;
      doc.hobbies.forEach(item => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${i}</td>
              <td>${item.number}</td>
              <td>${item.firstname} ${item.lastname}</td>
              <td>19 min 23 s</td>
          `;
          i++;
          tableBody.appendChild(row);
      });
    }
  

  


    const db = new PouchDB('https://canap_:plop1234$@couchdb-canap.alwaysdata.net:6984/canap_test1');
/*
    var doc = {
      "_id": "course_cat1",
      "name": "Course 2",
      "date": "06/07/2023",
      "hobbies": [
        {"firstname" : "titi", "lastname": "", "number": "23" },
        {"firstname" : "tata", "lastname": "", "number": "222" },
        {"firstname" : "toto", "lastname": "", "number": "555" }
      ]
    };
    db.put(doc);
  */  

  const intervalId = setInterval(() => {
    db.get('course_cat1').then(function (doc) {
      console.log(doc);
      updateTable(doc);
    });
  }, 1000);

  </script>
</html>
